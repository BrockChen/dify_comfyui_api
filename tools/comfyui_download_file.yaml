identity:
  name: "comfyui_download_file"
  author: "brockchen"
  label:
    en_US: "ComfyUI Download File"
    zh_Hans: "ComfyUI 下载文件"
description:
  human:
    en_US: "Download all output files from a ComfyUI workflow and upload them to Dify storage. Automatically fetches the workflow outputs by prompt_id and downloads all generated files."
    zh_Hans: "从 ComfyUI 工作流下载所有输出文件并上传到 Dify 存储。根据 prompt_id 自动获取工作流输出并下载所有生成的文件。"
  llm: "Download all output files from a ComfyUI workflow using the prompt_id. This tool automatically fetches the workflow execution history, extracts all output files (images/videos), downloads them from ComfyUI, and uploads them to Dify storage."
parameters:
  - name: prompt_id
    type: string
    required: true
    label:
      en_US: Prompt ID
      zh_Hans: 提示 ID
    human_description:
      en_US: "The prompt_id returned from the submit workflow tool."
      zh_Hans: "从提交工作流工具返回的 prompt_id。"
    llm_description: "The prompt_id obtained from submitting a workflow. Use this to query the execution status and retrieve results."
    form: llm
      
output_schema:
  type: object
  properties:
    status:
      type: string
      description: "Download status (success or failed)"
    prompt_id:
      type: string
      description: "The prompt_id used for downloading"
    total_files:
      type: number
      description: "Total number of output files"
    downloaded:
      type: number
      description: "Number of successfully downloaded files"
    failed:
      type: number
      description: "Number of failed downloads"
    files:
      type: array
      description: "List of downloaded files with their Dify URLs"
      items:
        type: object
        properties:
          filename:
            type: string
          dify_url:
            type: string
          comfyui_url:
            type: string
          size:
            type: number
extra:
  python:
    source: tools/comfyui_download_file.py

